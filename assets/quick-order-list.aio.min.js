/*
Generated time: October 24, 2025 20:34
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
customElements.get("quick-order-list")||customElements.define("quick-order-list",class extends BulkAdd{cartUpdateUnsubscriber=void 0;hasPendingQuantityUpdate=!1;constructor(){super(),this.isListInsideModal=this.closest("bulk-modal"),this.stickyHeaderElement=document.querySelector("sticky-header"),this.stickyHeaderElement&&(this.stickyHeader={height:this.stickyHeaderElement.offsetHeight,type:""+this.stickyHeaderElement.getAttribute("data-sticky-type")}),this.totalBar=this.getTotalBar(),this.totalBar&&(this.totalBarPosition=window.innerHeight-this.totalBar.offsetHeight,this.handleResize=this.handleResize.bind(this),window.addEventListener("resize",this.handleResize)),this.querySelector("form").addEventListener("submit",t=>t.preventDefault())}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,async t=>{t.source!==this.id&&(this.toggleTableLoading(!0),await this.refresh(),this.toggleTableLoading(!1))}),this.initEventListeners()}disconnectedCallback(){this.cartUpdateUnsubscriber?.(),window.removeEventListener("resize",this.handleResize)}handleResize(){this.totalBarPosition=window.innerHeight-this.totalBar.offsetHeight,this.stickyHeader.height=this.stickyHeaderElement?this.stickyHeaderElement.offsetHeight:0}initEventListeners(){this.querySelectorAll(".pagination__item").forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault(),t.stopPropagation();t=new URL(t.currentTarget.href);this.toggleTableLoading(!0),await this.refresh(t.searchParams.get("page")||"1"),this.scrollTop(),this.toggleTableLoading(!1)})}),this.querySelector(".quick-order-list__contents").addEventListener("keyup",this.handleScrollIntoView.bind(this)),this.quickOrderListTable.addEventListener("keydown",this.handleSwitchVariantOnEnter.bind(this)),this.initVariantEventListeners()}initVariantEventListeners(){this.allInputsArray=Array.from(this.querySelectorAll('input[type="number"]')),this.querySelectorAll("quantity-input").forEach(t=>{let e=debounce(this.onChange.bind(this),BulkAdd.ASYNC_REQUEST_DELAY,!0);t.addEventListener("change",t=>{this.hasPendingQuantityUpdate=!0,e(t)})}),this.querySelectorAll(".quick-order-list-remove-button").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),this.toggleLoading(!0),this.startQueue(e.dataset.index,0)})})}get currentPage(){return this.querySelector(".pagination-wrapper")?.dataset?.page??"1"}get cartVariantsForProduct(){return JSON.parse(this.querySelector("[data-cart-contents]")?.innerHTML||"[]")}onChange(t){var e=parseInt(t.target.value);this.cleanErrorMessageOnType(t),0==e?(t.target.setAttribute("value",e),this.startQueue(t.target.dataset.index,e)):this.validateQuantity(t)}cleanErrorMessageOnType(t){let e=()=>{t.target.setCustomValidity(" "),t.target.reportValidity(),t.target.removeEventListener("keydown",e)};t.target.addEventListener("keydown",e)}validateInput(t){var e=parseInt(t.value),i=parseInt(t.dataset.min),r=parseInt(t.step);return t.max?0==e||i<=e&&e<=parseInt(t.max)&&e%r==0:0==e||i<=e&&e%r==0}get quickOrderListTable(){return this.querySelector(".quick-order-list__table")}getSectionsToRender(){return[{id:this.id,section:this.dataset.section,selector:"#"+this.id},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:"#shopify-section-cart-icon-bubble"},{id:"quick-order-list-live-region-text-"+this.dataset.productId,section:"cart-live-region-text",selector:".shopify-section"},{id:"CartDrawer",selector:".drawer__inner",section:"cart-drawer"}]}toggleTableLoading(t){this.quickOrderListTable.classList.toggle("quick-order-list__container--disabled",t),this.toggleLoading(t)}async refresh(t=null){var e=this.dataset.url||window.location.pathname;return fetch(`${e}?section_id=${this.dataset.section}&page=`+(t||this.currentPage)).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector("#"+this.id);t&&(this.innerHTML=t.innerHTML,this.initEventListeners())}).catch(t=>{console.error(t)})}renderSections(t){let{items:o,sections:l}=t;this.getSectionsToRender().forEach(({id:t,selector:e,section:i})=>{t=document.getElementById(t);if(t){var r=(new DOMParser).parseFromString(l[i],"text/html").querySelector(e);if(i===this.dataset.section){if(!(0<this.queue.length||this.hasPendingQuantityUpdate)){var s=document.activeElement;let t=s?.dataset?.target;t?.includes("remove")&&(t=s.closest("quantity-popover")?.querySelector('[data-target*="increment-"]')?.dataset.target);var s=this.getTotalBar(),s=(s&&(s.innerHTML=r.querySelector(".quick-order-list__total").innerHTML),this.quickOrderListTable),a=r.querySelector(".quick-order-list__table"),n=this.currentPage===(r.querySelector(".pagination-wrapper")?.dataset.page??"1");a&&n&&(s.innerHTML=a.innerHTML,(n=this.querySelector(`[data-target='${t}']`))&&n?.focus({preventScroll:!0}),this.initVariantEventListeners())}}else"cart-drawer"===i?(t.closest("cart-drawer")?.classList.toggle("is-empty",0===o.length),t.querySelector(e).innerHTML=r.innerHTML):t.innerHTML=r.innerHTML}})}getTotalBar(){return this.querySelector(".quick-order-list__total")}scrollTop(){var t=this.getBoundingClientRect().top;this.isListInsideModal?this.scrollIntoView():window.scrollTo({top:t+window.scrollY-(this.stickyHeader?.height||0),behavior:"instant"})}scrollQuickOrderListTable(t){var e,i,r,s=t.getBoundingClientRect().top,a=t.getBoundingClientRect().bottom;this.isListInsideModal?(e=a>this.totalBar.getBoundingClientRect().top,i=s<this.querySelector(".quick-order-list__table thead").getBoundingClientRect().bottom,(e||i)&&this.scrollToCenter(t)):(e=this.stickyHeaderElement?.getBoundingClientRect().bottom,i=a>this.totalBarPosition,a=a<this.querySelector(".variant-item__quantity-wrapper").offsetHeight,r=this.stickyHeaderElement&&"on-scroll-up"!==this.stickyHeader.type&&this.stickyHeader.height>s,s=this.stickyHeaderElement&&"on-scroll-up"===this.stickyHeader.type&&this.stickyHeader.height>s&&0<e,(i||a||r||s)&&this.scrollToCenter(t))}scrollToCenter(t){t.scrollIntoView({block:"center",behavior:"smooth"})}handleScrollIntoView(t){"Tab"!==t.key&&"Enter"!==t.key||1===this.allInputsArray.length||this.scrollQuickOrderListTable(t.target)}handleSwitchVariantOnEnter(t){"Enter"!==t.key||"INPUT"!==t.target.tagName||(t.preventDefault(),t.target.blur(),!this.validateInput(t.target))||this.allInputsArray.length<=1||(t=(this.allInputsArray.indexOf(t.target)+(t.shiftKey?-1:1)+this.allInputsArray.length)%this.allInputsArray.length,this.allInputsArray[t]?.select())}updateMultipleQty(t){0==this.queue.length&&(this.hasPendingQuantityUpdate=!1),this.toggleLoading(!0);var e=this.dataset.url||window.location.pathname,t=JSON.stringify({updates:t,sections:this.getSectionsToRender().map(({section:t})=>t),sections_url:e+"?page="+this.currentPage});this.updateMessage(),this.setErrorMessage(),fetch(""+routes.cart_update_url,{...fetchConfig(),body:t}).then(t=>t.text()).then(async t=>{t=JSON.parse(t);this.renderSections(t),publish(PUB_SUB_EVENTS.cartUpdate,{source:this.id,cartData:t})}).catch(t=>{console.error(t),this.setErrorMessage(window.cartStrings.error)}).finally(()=>{0===this.queue.length&&this.toggleLoading(!1),this.setRequestStarted(!1)})}setErrorMessage(i=null){this.errorMessageTemplate=this.errorMessageTemplate??document.getElementById("QuickOrderListErrorTemplate-"+this.dataset.productId).cloneNode(!0),document.querySelectorAll(".quick-order-list-error").forEach(t=>{var e;t.innerHTML="",i&&((e=this.errorMessageTemplate.cloneNode(!0)).content.querySelector(".quick-order-list-error-message").innerText=i,t.appendChild(e.content))})}updateMessage(t=null){var r=this.querySelectorAll(".quick-order-list__message-text"),s=this.querySelectorAll(".quick-order-list__message-icon");if(null===t||isNaN(t))r.forEach(t=>t.innerHTML=""),s.forEach(t=>t.classList.add("hidden"));else{var a=t<0;let e=Math.abs(t),i=a?1===e?window.quickOrderListStrings.itemRemoved:window.quickOrderListStrings.itemsRemoved:1===t?window.quickOrderListStrings.itemAdded:window.quickOrderListStrings.itemsAdded;r.forEach(t=>t.innerHTML=i.replace("[quantity]",e)),a||s.forEach(t=>t.classList.remove("hidden"))}}updateError(t,e){let i="";i=void 0===t?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",t),this.updateLiveRegions(e,i)}updateLiveRegions(t,e){t=document.getElementById("Quick-order-list-item-error-desktop-"+t);t&&(t.querySelector(".variant-item__error-text").innerHTML=e,t.closest("tr").classList.remove("hidden")),variantItemErrorMobile&&(variantItemErrorMobile.querySelector(".variant-item__error-text").innerHTML=e),this.querySelector("#shopping-cart-variant-item-status").setAttribute("aria-hidden",!0);let i=document.getElementById("quick-order-list-live-region-text");i.setAttribute("aria-hidden",!1),setTimeout(()=>{i.setAttribute("aria-hidden",!0)},1e3)}toggleLoading(e,t=this){t.querySelector("#shopping-cart-variant-item-status").toggleAttribute("aria-hidden",!e),t.querySelectorAll(".variant-remove-total .loading__spinner")?.forEach(t=>t.classList.toggle("hidden",!e))}}),customElements.get("quick-order-list-remove-all-button")||customElements.define("quick-order-list-remove-all-button",class extends HTMLElement{constructor(){super(),this.quickOrderList=this.closest("quick-order-list"),this.actions={confirm:"confirm",remove:"remove",cancel:"cancel"},this.addEventListener("click",t=>{t.preventDefault(),this.dataset.action===this.actions.confirm?this.toggleConfirmation(!1,!0):this.dataset.action===this.actions.remove?(t=this.quickOrderList.cartVariantsForProduct.reduce((t,e)=>({...t,[e]:0}),{}),this.quickOrderList.updateMultipleQty(t),this.toggleConfirmation(!0,!1)):this.dataset.action===this.actions.cancel&&this.toggleConfirmation(!0,!1)})}toggleConfirmation(t,e){this.quickOrderList.querySelector(".quick-order-list-total__confirmation").classList.toggle("hidden",t),this.quickOrderList.querySelector(".quick-order-list-total__info").classList.toggle("hidden",e)}});