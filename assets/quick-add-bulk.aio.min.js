/*
Generated time: October 24, 2025 20:34
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
customElements.get("quick-add-bulk")||customElements.define("quick-add-bulk",class extends BulkAdd{constructor(){super(),this.quantity=this.querySelector("quantity-input");var t=debounce(t=>{0===parseInt(t.target.value)?this.startQueue(t.target.dataset.index,parseInt(t.target.value)):this.validateQuantity(t)},ON_CHANGE_DEBOUNCE_TIMER);this.addEventListener("change",t.bind(this)),this.listenForActiveInput(),this.listenForKeydown(),this.lastActiveInputId=null}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,t=>{"quick-add"===t.source||t.cartData.items&&!t.cartData.items.some(t=>t.id===parseInt(this.dataset.index))||t.cartData.variant_id&&t.cartData.variant_id!==parseInt(this.dataset.index)||this.onCartUpdate().then(()=>{this.listenForActiveInput(),this.listenForKeydown()})})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}get input(){return this.querySelector("quantity-input input")}selectProgressBar(){return this.querySelector(".progress-bar-container")}listenForActiveInput(){this.classList.contains("hidden")||this.input?.addEventListener("focusin",t=>t.target.select()),this.isEnterPressed=!1}listenForKeydown(){this.input?.addEventListener("keydown",t=>{"Enter"===t.key&&(this.input?.blur(),this.isEnterPressed=!0)})}cleanErrorMessageOnType(t){t.target.addEventListener("keypress",()=>{t.target.setCustomValidity("")},{once:!0})}get sectionId(){return this._sectionId||(this._sectionId=this.closest(".collection-quick-add-bulk").dataset.id),this._sectionId}onCartUpdate(){return new Promise((e,s)=>{fetch(this.getSectionsUrl()+"?section_id="+this.sectionId).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector(`#quick-add-bulk-${this.dataset.index}-`+this.sectionId);t&&(this.innerHTML=t.innerHTML),e()}).catch(t=>{console.error(t),s(t)})})}getSectionsUrl(){var t=new URLSearchParams(window.location.search),t=decodeURIComponent(t.get("page")||"");return window.location.pathname+(t?"?page="+t:"")}updateMultipleQty(t){this.selectProgressBar().classList.remove("hidden");let e=Object.keys(t);t=JSON.stringify({updates:t,sections:this.getSectionsToRender().map(t=>t.section),sections_url:this.getSectionsUrl()});fetch(""+routes.cart_update_url,{...fetchConfig(),body:t}).then(t=>t.text()).then(t=>{t=JSON.parse(t);this.renderSections(t,e),publish(PUB_SUB_EVENTS.cartUpdate,{source:"quick-add",cartData:t})}).catch(()=>{}).finally(()=>{this.selectProgressBar().classList.add("hidden"),this.setRequestStarted(!1)})}getSectionsToRender(){return[{id:`quick-add-bulk-${this.dataset.index}-`+this.sectionId,section:this.sectionId,selector:`#quick-add-bulk-${this.dataset.index}-`+this.sectionId},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"CartDrawer",selector:".drawer__inner",section:"cart-drawer"}]}renderSections(s,e){0===this.queue.filter(t=>e.includes(t.id)).length&&(this.getSectionsToRender().forEach(t=>{var e=document.getElementById(t.id),e=("cart-drawer"===t.section&&e.closest("cart-drawer")?.classList.toggle("is-empty",0===s.items.length.length),e&&e.querySelector(t.selector)?e.querySelector(t.selector):e);e&&(e.innerHTML=this.getSectionInnerHTML(s.sections[t.section],t.selector))}),this.isEnterPressed&&this.querySelector("#Quantity-"+this.lastActiveInputId).select(),this.listenForActiveInput(),this.listenForKeydown())}});